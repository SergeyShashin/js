<script>

  const puzzle = [
    'ANGULAR',
    'REDNCAE',
    'RFIDTCL',
    'AGNEGSA',
    'YTIRTSP'
  ];

  console.log(findWord(puzzle, 'ANGULAR')); //true
  // console.log(findWord(puzzle, 'REACT')); //true
  // console.log(findWord(puzzle, 'ARRAY')); //true


  /*
  Возвращает true, если в puzzle можно собрать слово word. В остальных случая false.
  Перемещаться можно по вертикали или горизонтали. Нарушть границы нельзя. Буквы из puzzle можно использовать только 1 раз.
  */
  function findWord(puzzle, word) {
    let result = true;
    const alphabet = englishAlphabet();
    const matrix = [];
    let lengthPuzzle = puzzle.length;

    //собираем объект с индексами букв puzzle
    puzzle.map((row, idxRow) => {
      matrix.push(row);
      row.split('').map((col, idxCol) => {
        alphabet[col].push({ row: idxRow, col: idxCol });
        matrix[idxRow][idxCol] = col;
      })
    })

    // console.log(alphabet);

    word.split('').map((char, idxChar) => {
      if (alphabet[char] && word[idxChar + 1]) {

        console.log('этот символ ' + char);
        console.log(alphabet[char]);

        let nextChar = word[idxChar + 1];
        console.log('следующий символ ' + nextChar);
        console.log(alphabet[nextChar]);

        if (!checkStep(alphabet[char], alphabet[nextChar], lengthPuzzle)) {
          result = false;
          return
        }

        // проверка возможности наличия пути из последнего символа word в предпоследний
      } else if (word[idxChar]) {
        console.log('зашли сюда ');

        let prevChar = word[idxChar - 1];
        console.log('символ ' + prevChar);
        console.log(alphabet[prevChar]);

        let lastChar = word[idxChar];
        console.log('символ ' + lastChar);
        console.log(alphabet[lastChar]);

        if (!checkStep(alphabet[prevChar], alphabet[lastChar], lengthPuzzle)) {
          result = false;
          return
        }

      }
      else {
        result = false;
        return
      }

    });

    return result
  }

  /*
  Создаёт объект с английскими буквами
  */
  function englishAlphabet() {
    const alphabet = {};

    for (let i = 65; i < 91; i++) {
      alphabet[String.fromCharCode(i)] = [];
    }

    return alphabet
  }

  /*
  Возращает true, если можно шагнуть к следующей букве и false, если нельзя 
  */
  function checkStep(coordinatesChar, coordinatesNextChar, lengthPuzzle) {

    let isStepLeft;
    let isStepRight;
    let isStepTop;
    let isStepBottom;

    for (let coordinateNextChar of coordinatesNextChar) {

      let nextCol = coordinateNextChar.col;
      let nextRow = coordinateNextChar.row;

      if (nextCol - 1 >= 0) {
        if (checkStepLeftOrRight(coordinatesChar, nextCol - 1)) {
          // console.log('Вариант есть');
          // console.log(coordinateNextChar);
          isStepLeft = true;
        };
      }

      if (nextCol + 1 <= lengthPuzzle) {
        if (checkStepLeftOrRight(coordinatesChar, nextCol + 1)) {
          // console.log('Вариант есть');
          // console.log(coordinateNextChar);
          isStepRight = true;
        };
      }

      if (nextRow - 1 >= 0) {
        console.log(`Предыдущий символ!!! ${nextRow - 1}`);
        if (checkStepTopOrBottom(coordinatesChar, nextRow - 1)) {
          // console.log('Вариант есть');
          // console.log(coordinateNextChar);
          isStepTop = true;
        };
      }


    }

    console.log('Возможность шагать влево ' + isStepLeft);
    console.log('Возможность шагать вправо ' + isStepRight);
    console.log('Возможность шагать вверх ' + isStepTop);
    console.log('Возможность шагать вниз ' + isStepBottom);

    return isStepLeft || isStepRight || isStepTop || isStepBottom;
  }

  /*
  Возвращает true если шаг влево или вправо воможен
  */
  function checkStepLeftOrRight(coordinatesChar, col) {

    for (let coordinateChar of coordinatesChar) {

      if (coordinateChar.col === col) {
        return true
      }

    }

  }

  /*
  Возвращает true если шаг вверх или вниз возможен
  */
  function checkStepTopOrBottom(coordinatesChar, row) {

    for (let coordinateChar of coordinatesChar) {

      if (coordinateChar.row === row) {
        return true
      }

    }

  }




</script>